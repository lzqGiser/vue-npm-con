/** * Created by lzq on 2017/9/27. */const stylus = require('stylus');const fs = require('fs');const fse = require('fs-extra');const glob = require('glob');const path = require('path');/** transform .styl file* @param outputRoot {string} outputRoot is root catalog* @param module {string}*/const stylTransform = (outputRoot, module)=>{     // module :  "src/theme/**/*.styl"    glob(module,function(err, files){        if (err) { console.log(err)}        files.map(function(file){            const currentPath = path.resolve(file);            fs.readFile(currentPath,'utf8', function(err, data){                if(err){console.log(`stylus-transform readFile error: ${err}`)}                const pathMatch = currentPath.match(/\/theme\/[a-zA-Z0-9]*.styl$/);                if(pathMatch){                    const pathMatchFirst = pathMatch[0];                    const filePath = outputRoot + pathMatchFirst.replace(/styl/,'css');                    stylus.render(data,{'filename': currentPath},function(err,css){                        if(err){console.log(`stylus render current error: ${err}`)}                        fse.outputFile(filePath, css, function(err){                            if(err) console.log(`output css file current error: ${err}`);                        })                    });                }            });        });    });};module.exports = stylTransform;